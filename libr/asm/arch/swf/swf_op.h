/* radare - LGPL3 - 2016 - xarkes */

#ifndef SWFOP_H
#define SWFOP_H

static swf_op_t SWF_OP_UNKNOWN = {0, "unknown"};
static swf_tag_t SWF_TAG_UNKNOWN = {0, "UnknownTag"};

enum {
SWFACTION_END						= 0x00,

/* v3 actions */
SWFACTION_NEXTFRAME					= 0x04,
SWFACTION_PREVFRAME					= 0x05,
SWFACTION_PLAY						= 0x06,
SWFACTION_STOP						= 0x07,
SWFACTION_TOGGLEQUALITY				= 0x08,
SWFACTION_STOPSOUNDS				= 0x09,
SWFACTION_GOTOFRAME					= 0x81,	/* >= 0x80 means record	has	args */
SWFACTION_GETURL					= 0x83,
SWFACTION_IFFRAMELOADED				= 0x8A,
SWFACTION_SETTARGET					= 0x8B,
SWFACTION_GOTOLABEL					= 0x8C,

/* v4 actions */
SWFACTION_ADD						= 0x0A,
SWFACTION_SUBTRACT					= 0x0B,
SWFACTION_MULTIPLY					= 0x0C,
SWFACTION_DIVIDE					= 0x0D,
SWFACTION_EQUALS					= 0x0E,
SWFACTION_LESSTHAN					= 0x0F,
SWFACTION_LOGICALAND				= 0x10,
SWFACTION_LOGICALOR					= 0x11,
SWFACTION_LOGICALNOT				= 0x12,
SWFACTION_STRINGEQ					= 0x13,
SWFACTION_STRINGLENGTH				= 0x14,
SWFACTION_SUBSTRING					= 0x15,
SWFACTION_POP						= 0x17,
SWFACTION_INT						= 0x18,
SWFACTION_GETVARIABLE				= 0x1C,
SWFACTION_SETVARIABLE				= 0x1D,
SWFACTION_SETTARGETEXPRESSION		= 0x20,
SWFACTION_STRINGCONCAT				= 0x21,
SWFACTION_GETPROPERTY				= 0x22,
SWFACTION_SETPROPERTY				= 0x23,
SWFACTION_DUPLICATECLIP				= 0x24,
SWFACTION_REMOVECLIP				= 0x25,
SWFACTION_TRACE						= 0x26,
SWFACTION_STARTDRAGMOVIE			= 0x27,
SWFACTION_STOPDRAGMOVIE				= 0x28,
SWFACTION_STRINGLESSTHAN			= 0x29,
SWFACTION_RANDOM					= 0x30,
SWFACTION_MBLENGTH					= 0x31,
SWFACTION_ORD						= 0x32,
SWFACTION_CHR						= 0x33,
SWFACTION_GETTIMER					= 0x34,
SWFACTION_MBSUBSTRING				= 0x35,
SWFACTION_MBORD						= 0x36,
SWFACTION_MBCHR						= 0x37,
SWFACTION_IFFRAMELOADEDEXPRESSION	= 0x8D,
SWFACTION_PUSHDATA					= 0x96,
SWFACTION_BRANCHALWAYS				= 0x99,
SWFACTION_GETURL2					= 0x9A,
SWFACTION_BRANCHIFTRUE				= 0x9D,
SWFACTION_CALLFRAME					= 0x9E,
SWFACTION_GOTOEXPRESSION			= 0x9F,

/* v5 actions */
SWFACTION_DELETE					= 0x3A,
SWFACTION_DELETE2					= 0x3B,
SWFACTION_VAREQUALS					= 0x3C,
SWFACTION_CALLFUNCTION				= 0x3D,
SWFACTION_RETURN					= 0x3E,
SWFACTION_MODULO					= 0x3F,
SWFACTION_NEW						= 0x40,
SWFACTION_VAR						= 0x41,
SWFACTION_INITARRAY					= 0x42,
SWFACTION_INITOBJECT				= 0x43,
SWFACTION_TYPEOF					= 0x44,
SWFACTION_TARGETPATH				= 0x45,
SWFACTION_ENUMERATE					= 0x46,
SWFACTION_NEWADD					= 0x47,
SWFACTION_NEWLESSTHAN				= 0x48,
SWFACTION_NEWEQUALS					= 0x49,
SWFACTION_TONUMBER					= 0x4A,
SWFACTION_TOSTRING					= 0x4B,
SWFACTION_DUP						= 0x4C,
SWFACTION_SWAP						= 0x4D,
SWFACTION_GETMEMBER					= 0x4E,
SWFACTION_SETMEMBER					= 0x4F,
SWFACTION_INCREMENT					= 0x50,
SWFACTION_DECREMENT					= 0x51,
SWFACTION_CALLMETHOD				= 0x52,
SWFACTION_NEWMETHOD					= 0x53,
SWFACTION_BITWISEAND				= 0x60,
SWFACTION_BITWISEOR					= 0x61,
SWFACTION_BITWISEXOR				= 0x62,
SWFACTION_SHIFTLEFT					= 0x63,
SWFACTION_SHIFTRIGHT				= 0x64,
SWFACTION_SHIFTRIGHT2				= 0x65,
SWFACTION_SETREGISTER				= 0x87,
SWFACTION_CONSTANTPOOL				= 0x88,
SWFACTION_WITH						= 0x94,
SWFACTION_DEFINEFUNCTION			= 0x9B,

/* v6 actions */
SWFACTION_INSTANCEOF				= 0x54,
SWFACTION_ENUMERATEVALUE			= 0x55,
SWFACTION_STRICTEQUALS				= 0x66,
SWFACTION_GREATERTHAN				= 0x67,
SWFACTION_STRINGGREATERTHAN			= 0x68,
SWFACTION_STRICTMODE				= 0x89,

/* v7 actions */
SWFACTION_CAST						= 0x2B,
SWFACTION_IMPLEMENTS				= 0x2C,
SWFACTION_EXTENDS					= 0x69,
SWFACTION_DEFINEFUNCTION2			= 0x8E,
SWFACTION_TRY						= 0x8F,
SWFACTION_THROW						= 0x2A,

/* FlashLite */
SWFACTION_FSCOMMAND2				= 0x2D
};

static swf_op_t swf_op[] = {
{SWFACTION_END, "end"},
{SWFACTION_NEXTFRAME, "nextframe"},	
{SWFACTION_PREVFRAME, "prevframe"},
{SWFACTION_PLAY, "play"},
{SWFACTION_STOP, "stop"},
{SWFACTION_TOGGLEQUALITY, "togglequality"},
{SWFACTION_STOPSOUNDS, "stopsounds"},
{SWFACTION_GOTOFRAME, "gotoframe"},
{SWFACTION_GETURL, "geturl"},
{SWFACTION_IFFRAMELOADED, "iframeloaded"},
{SWFACTION_SETTARGET, "settarget"},
{SWFACTION_GOTOLABEL, "gotolabel"},
{SWFACTION_ADD, "add"},
{SWFACTION_SUBTRACT, "subtract"},
{SWFACTION_MULTIPLY, "multiply"},
{SWFACTION_DIVIDE, "divide"},
{SWFACTION_EQUALS, "equals"},
{SWFACTION_LESSTHAN, "lessthan"},
{SWFACTION_LOGICALAND, "and"},
{SWFACTION_LOGICALOR, "or"},
{SWFACTION_LOGICALNOT, "not"},
{SWFACTION_STRINGEQ, "stringeq"},
{SWFACTION_STRINGLENGTH, "stringlength"},
{SWFACTION_SUBSTRING, "substring"},
{SWFACTION_POP, "pop"},
{SWFACTION_INT, "int"},
{SWFACTION_GETVARIABLE, "getvariable"},
{SWFACTION_SETVARIABLE, "setvariable"},
{SWFACTION_SETTARGETEXPRESSION, "settargetexpression"},
{SWFACTION_STRINGCONCAT, "stringconcat"},
{SWFACTION_GETPROPERTY, "getproperty"},
{SWFACTION_SETPROPERTY, "setproperty"},
{SWFACTION_DUPLICATECLIP, "duplicateclip"},
{SWFACTION_REMOVECLIP, "removeclip"},
{SWFACTION_TRACE, "trace"},
{SWFACTION_STARTDRAGMOVIE, "startdragmovie"},
{SWFACTION_STOPDRAGMOVIE, "stopdragmovie"},
{SWFACTION_STRINGLESSTHAN, "stringlessthan"},
{SWFACTION_RANDOM, "random"},
{SWFACTION_MBLENGTH, "mblength"},
{SWFACTION_ORD, "ord"},
{SWFACTION_CHR, "chr"},
{SWFACTION_GETTIMER, "gettimer"},
{SWFACTION_MBSUBSTRING, "mbsubstring"},
{SWFACTION_MBORD, "mbord"},
{SWFACTION_MBCHR, "mbchr"},
{SWFACTION_IFFRAMELOADEDEXPRESSION, "ifframeloadedexpression"},
{SWFACTION_PUSHDATA, "pushdata"},
{SWFACTION_BRANCHALWAYS, "branchalways"},
{SWFACTION_GETURL2, "geturl2"},
{SWFACTION_BRANCHIFTRUE, "branchiftrue"},
{SWFACTION_CALLFRAME, "callframe"},
{SWFACTION_GOTOEXPRESSION, "gotoexpression"},
{SWFACTION_DELETE, "delete"},
{SWFACTION_DELETE2, "delete2"},
{SWFACTION_VAREQUALS, "varequals"},
{SWFACTION_CALLFUNCTION, "callfunction"},
{SWFACTION_RETURN, "return"},
{SWFACTION_MODULO, "modulo"},
{SWFACTION_NEW, "new"},
{SWFACTION_VAR, "var"},
{SWFACTION_INITARRAY, "initarray"},
{SWFACTION_INITOBJECT, "initobject"},
{SWFACTION_TYPEOF, "typeof"},
{SWFACTION_TARGETPATH, "targetpath"},
{SWFACTION_ENUMERATE, "enumerate"},
{SWFACTION_NEWADD, "newadd"},
{SWFACTION_NEWLESSTHAN, "newlessthan"},
{SWFACTION_NEWEQUALS, "newequals"},
{SWFACTION_TONUMBER, "tonumber"},
{SWFACTION_TOSTRING, "tostring"},
{SWFACTION_DUP, "dup"},
{SWFACTION_SWAP, "swap"},
{SWFACTION_GETMEMBER, "getmember"},
{SWFACTION_SETMEMBER, "setmember"},
{SWFACTION_INCREMENT, "increment"},
{SWFACTION_DECREMENT, "decrement"},
{SWFACTION_CALLMETHOD, "callmethod"},
{SWFACTION_NEWMETHOD, "newmethod"},
{SWFACTION_BITWISEAND, "bitwiseand"},
{SWFACTION_BITWISEOR, "bitwiseor"},
{SWFACTION_BITWISEXOR, "bitwisexor"},
{SWFACTION_SHIFTLEFT, "shiftleft"},
{SWFACTION_SHIFTRIGHT, "shiftright"},
{SWFACTION_SHIFTRIGHT2, "shiftright2"},
{SWFACTION_SETREGISTER, "setregister"},
{SWFACTION_CONSTANTPOOL, "constantpool"},
{SWFACTION_WITH, "with"},
{SWFACTION_DEFINEFUNCTION, "definefunction"},
{SWFACTION_INSTANCEOF, "instanceof"},
{SWFACTION_ENUMERATEVALUE, "enumeratevalue"},
{SWFACTION_STRICTEQUALS, "strictequals"},
{SWFACTION_GREATERTHAN, "greaterthan"},
{SWFACTION_STRINGGREATERTHAN, "stringgreaterthan"},
{SWFACTION_STRICTMODE, "strictmode"},
{SWFACTION_CAST, "cast"},
{SWFACTION_IMPLEMENTS, "implements"},
{SWFACTION_EXTENDS, "extends"},
{SWFACTION_DEFINEFUNCTION2, "definefunction2"},
{SWFACTION_TRY, "try"},
{SWFACTION_THROW, "throw"},
{SWFACTION_FSCOMMAND2, "fscommand2"},
{-1, NULL}
};

enum {
TAG_END								= 0,  /* end tag for movie clip or swf */
TAG_SHOWFRAME						= 1,  /* frame is completely described now, please show */
TAG_DEFINESHAPE						= 2,
TAG_FREECHARACTER					= 3,
TAG_PLACEOBJECT						= 4,
TAG_REMOVEOBJECT					= 5,
TAG_DEFINEBITS						= 6,
TAG_DEFINEBUTTON					= 7,
TAG_JPEGTABLES						= 8,
TAG_SETBACKGROUNDCOLOR				= 9,
TAG_DEFINEFONT						= 10,
TAG_DEFINETEXT						= 11,
TAG_DOACTION						= 12, /* normal action block */
TAG_DEFINEFONTINFO					= 13,
TAG_DEFINESOUND						= 14,
TAG_STARTSOUND						= 15,
TAG_STOPSOUND						= 16,
TAG_DEFINEBUTTONSOUND				= 17,
TAG_SOUNDSTREAMHEAD					= 18,
TAG_SOUNDSTREAMBLOCK				= 19,
TAG_DEFINEBITSLOSSLESS				= 20,
TAG_DEFINEBITSJPEG2					= 21,
TAG_DEFINESHAPE2					= 22,
TAG_DEFINEBUTTONCXFORM				= 23,
TAG_PROTECT							= 24, /* the author doesn't want the file to be opened */
TAG_PATHSAREPOSTSCRIPT				= 25,
TAG_PLACEOBJECT2					= 26, /* possibly onClipEvents inside */
TAG_REMOVEOBJECT2					= 28,
TAG_SYNCFRAME						= 29,
TAG_FREEALL							= 31,
TAG_DEFINESHAPE3					= 32,
TAG_DEFINETEXT2						= 33,
TAG_DEFINEBUTTON2					= 34, /* possibly button events inside */
TAG_DEFINEBITSJPEG3					= 35,
TAG_DEFINEBITSLOSSLESS2				= 36,
TAG_DEFINEEDITTEXT					= 37,
TAG_DEFINEVIDEO						= 38,
TAG_DEFINEMOVIECLIP					= 39, /* movie clip timeline comes */
TAG_NAMECHARACTER					= 40,
TAG_SERIALNUMBER					= 41,
TAG_DEFINETEXTFORMAT				= 42,
TAG_FRAMELABEL						= 43,
TAG_SOUNDSTREAMHEAD2				= 45,
TAG_DEFINEMORPHSHAPE				= 46,
TAG_GENFRAME						= 47,
TAG_DEFINEFONT2						= 48,
TAG_GENCOMMAND						= 49,
TAG_DEFINECOMMANDOBJ				= 50,
TAG_CHARACTERSET					= 51,
TAG_FONTREF							= 52,
TAG_EXPORTASSETS					= 56,
TAG_IMPORTASSETS					= 57,
TAG_ENABLEDEBUGGER					= 58,
TAG_INITMOVIECLIP					= 59, /* flash 6 mc initialization actions (#initclip .. #endinitclip) */
TAG_DEFINEVIDEOSTREAM				= 60,
TAG_VIDEOFRAME						= 61,
TAG_DEFINEFONTINFO2					= 62,
TAG_DEBUGID							= 63,
TAG_ENABLEDEBUGGER2					= 64,
TAG_SCRIPTLIMITS					= 65,
TAG_SETTABINDEX						= 66,
TAG_DEFINESHAPE4					= 67,
TAG_FILEATTRIBUTES					= 69,
TAG_PLACEOBJECT3					= 70, /* possibly onClipEvents inside */
TAG_IMPORTASSETS2					= 71,
TAG_DEFINEFONTINFO3					= 73,
TAG_DEFINETEXTINFO					= 74,
TAG_DEFINEFONT3						= 75,
TAG_AVM2DECL						= 76,
TAG_METADATA						= 77,
TAG_SLICE9							= 78,
TAG_AVM2ACTION						= 82,
TAG_DEFINESHAPE5					= 83,
TAG_DEFINEMORPHSHAPE2				= 84,
TAG_DEFINEBITSPTR					= 1023
};


static swf_tag_t swf_tag[] = {
{TAG_END, "End"},
{TAG_SHOWFRAME, "ShowFrame"},
{TAG_DEFINESHAPE, "DefineShape"},
{TAG_FREECHARACTER, "FreeCharacter"},
{TAG_PLACEOBJECT, "PlaceObject"},
{TAG_REMOVEOBJECT, "RemoveObject"},
{TAG_DEFINEBITS, "DefineBits"},
{TAG_DEFINEBUTTON, "DefineButton"},
{TAG_JPEGTABLES, "JPEGTables"},
{TAG_SETBACKGROUNDCOLOR, "SetBackgroundColor"},
{TAG_DEFINEFONT, "DefineFont"},
{TAG_DEFINETEXT, "DefineText"},
{TAG_DOACTION, "DoAction"},
//TODO
{TAG_DEFINEVIDEOSTREAM, "DefineVideoStream"},
{TAG_VIDEOFRAME, "VideoFrame"},
{TAG_DEFINEFONTINFO2, "DefineFontInfo2"},
{TAG_DEBUGID, "DebugId"},
{TAG_ENABLEDEBUGGER2, "EnableDebugger2"},
{TAG_SCRIPTLIMITS, "ScriptLimits"},
{TAG_SETTABINDEX, "SetTabIndex"},
{TAG_DEFINESHAPE4, "DefineShape4"},
{TAG_FILEATTRIBUTES, "FileAttributes"},
{TAG_PLACEOBJECT3, "PlaceObject3"},
{TAG_IMPORTASSETS2, "ImportAssets2"},
{TAG_DEFINEFONTINFO3, "DefineFontInfo3"},
{TAG_DEFINETEXTINFO, "DefineTextInfo"},
{TAG_DEFINEFONT3, "DefineFont3"},
{TAG_AVM2DECL, "AVM2DECL"},
{TAG_METADATA, "Metadata"},
{TAG_SLICE9, "Slice9"},
{TAG_AVM2ACTION, "AVM2Action"},
{TAG_DEFINESHAPE5, "DefineShape5"},
{TAG_DEFINEMORPHSHAPE2, "DefineMorphShape2"},
{TAG_DEFINEBITSPTR, "DefineBitsPtr"},
{-1, NULL}
};

#endif // SWFOP_H
