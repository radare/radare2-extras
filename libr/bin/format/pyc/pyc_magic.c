/* radare - LGPL3 - Copyright 2016 - Matthieu (c0riolis) Tardy */

#include "pyc_magic.h"

static struct pyc_version versions[] = {
	{MAGIC_0_9_4_BETA,         "0.9.4 beta", "77b80a91d357c1d95d8e7cd4cbbe799e5deb777e", false},
	{MAGIC_0_9_9_v0,           "0.9.9",      "1cabc2b6c9701aea29bb506b593946e67bf7593a", false},
	{MAGIC_0_9_9_v1,           "0.9.9",      "f820e6917f07e5012bdd103ef97389318d5a10f8", false},
	{MAGIC_0_9_9_v2,           "0.9.9",      "9fed5726a36d7ce1355c30592838d93321d580ee", false},
	{MAGIC_1_0_1,              "1.0.1",      "1808ca5d8883097c72c6a8a89143041c20ea13c1", false},
	{MAGIC_1_1,                "1.1",        "d1e6c9a64a563841f60177ac907739f953f15630", false},
	{MAGIC_1_2,                "1.2",        "fb3daf9b2456dc1a3d99f56f78c5e6270eeaf1e8", false},
	{MAGIC_1_3_B1,             "1.3b1",      "0261bf5b3819b03d83f254562947244634604026", false},
	{MAGIC_1_4_B1_v0,          "1.4b1",      "d1ae0ea9a585f912d7aa3d004ff817d0dea112f8", false},
	{MAGIC_1_4_B1_v1,          "1.4b1",      "22e29b1747e139d9598eaa5126c59313af39949d", false},
	{MAGIC_1_4,                "1.4",        "b82d847b3dcbccd63de075e3879a9369dfb34e0d", false},
	{MAGIC_1_5_A1,             "1.5a1",      "104a646fc7a67f27df25d4e941b20035e5876f9f", false},
	{MAGIC_1_6_A2,             "1.6a2",      "84cd52b560e571eba371d7136abcc9c42c27b002", false},
	{MAGIC_2_0_B1_v0,          "2.0b1",      "f79434ee41fa86019216240ba32be660bcfc5419", false},
	{MAGIC_2_0_B1_v1,          "2.0b1",      "4388249506d190a76a4dbbbc70294ef6ba0656d5", false},
	{MAGIC_2_0_B1_v1_U,        "2.0b1",      "4388249506d190a76a4dbbbc70294ef6ba0656d5", true,},
	{MAGIC_2_0_B1_v2,          "2.0b1",      "4eaa463c031a1bdb5e7791c370d04108e0682dd4", false},
	{MAGIC_2_0_B1_v2_U,        "2.0b1",      "4eaa463c031a1bdb5e7791c370d04108e0682dd4", true },
	{MAGIC_2_0_B1_v3,          "2.0b1",      "18385172fac0b7099bd2d2264df614ed4466f083", false},
	{MAGIC_2_0_B1_v3_U,        "2.0b1",      "18385172fac0b7099bd2d2264df614ed4466f083", true },
	{MAGIC_2_0_B1_v4,          "2.0b1",      "f657dc8ff25e93b877305bbcfc45e360191bb326", false},
	{MAGIC_2_0_B1_v4_U,        "2.0b1",      "f657dc8ff25e93b877305bbcfc45e360191bb326", true },
	{MAGIC_2_0_B1_v5,          "2.0b1",      "1b9fd0cbd914947cc421ba7e45aa093d7ba9af00", false},
	{MAGIC_2_0_B1_v5_U,        "2.0b1",      "1b9fd0cbd914947cc421ba7e45aa093d7ba9af00", true },
	{MAGIC_2_0_B1_v6,          "2.0b1",      "1f1a156ed5af8f7a50ce05fc85f85423a24f2aa4", false},
	{MAGIC_2_0_B1_v6_U,        "2.0b1",      "1f1a156ed5af8f7a50ce05fc85f85423a24f2aa4", true },
	{MAGIC_2_1_A1,             "2.1a1",      "fd8c7203251ff37dbb397f7d423ae41f16a03c68", false},
	{MAGIC_2_1_A1_U,           "2.1a1",      "fd8c7203251ff37dbb397f7d423ae41f16a03c68", true },
	{MAGIC_2_1_A2,             "2.1a2",      "0076e8d28f9eba9eff4508696dc33730af2b4001", false},
	{MAGIC_2_1_A2_U,           "2.1a2",      "0076e8d28f9eba9eff4508696dc33730af2b4001", true },
	{MAGIC_2_2_A0,             "2.2a0",      "32e7d0898eab85de8134f932680a85c6e7abcec0", false},
	{MAGIC_2_2_A0_U,           "2.2a0",      "32e7d0898eab85de8134f932680a85c6e7abcec0", true },
	{MAGIC_2_2_A1,             "2.2a1",      "09df3254b49d7c9306585302fe815ab0bdb53439", false},
	{MAGIC_2_2_A1_U,           "2.2a1",      "09df3254b49d7c9306585302fe815ab0bdb53439", true },
	{MAGIC_2_3_A0_v0,          "2.3a0",      "abedb2418f6231adf24205092a59996f1f1e4c02", false},
	{MAGIC_2_3_A0_v0_U,        "2.3a0",      "abedb2418f6231adf24205092a59996f1f1e4c02", true },
	{MAGIC_2_3_A0_v1,          "2.3a0",      "d6ae544acd24a1f72ce00534fed464fde91ee504", false},
	{MAGIC_2_3_A0_v1_U,        "2.3a0",      "d6ae544acd24a1f72ce00534fed464fde91ee504", true },
	{MAGIC_2_3_A0_v2,          "2.3a0",      "cf5928fab108de9fbe02632d07176c717c2b3aa7", false},
	{MAGIC_2_3_A0_v2_U,        "2.3a0",      "cf5928fab108de9fbe02632d07176c717c2b3aa7", true },
	{MAGIC_2_3_A0_v3,          "2.3a0",      "5fe4d93df429134ef8695c12e59ff962ff8b73d2", false},
	{MAGIC_2_3_A0_v3_U,        "2.3a0",      "5fe4d93df429134ef8695c12e59ff962ff8b73d2", true },
	{MAGIC_2_4_A0_v0,          "2.4a0",      "adb42a71169604d3609ac2fbdb64cf8cd1c7250b", false},
	{MAGIC_2_4_A0_v0_U,        "2.4a0",      "adb42a71169604d3609ac2fbdb64cf8cd1c7250b", true },
	{MAGIC_2_4_A0_v1,          "2.4a0",      "3df36e2e5ddc1149af8eb52e20bc225d806236d4", false},
	{MAGIC_2_4_A0_v1_U,        "2.4a0",      "3df36e2e5ddc1149af8eb52e20bc225d806236d4", true },
	{MAGIC_2_4_A2,             "2.4a2",      "1f9b9c226b43ed20cb61e6d21aea6cb966e8bcd3", false},
	{MAGIC_2_4_A2_U,           "2.4a2",      "1f9b9c226b43ed20cb61e6d21aea6cb966e8bcd3", true },
	{MAGIC_2_4_A3,             "2.4a3",      "2b49b4a85d9eb4a4cfa9f29c21d649c383945671", false},
	{MAGIC_2_4_A3_U,           "2.4a3",      "2b49b4a85d9eb4a4cfa9f29c21d649c383945671", true },
	{MAGIC_2_5_A0_v0,          "2.5a0",      "44e3f21f052590ddfabc12909af5188a4cd89d8c", false},
	{MAGIC_2_5_A0_v0_U,        "2.5a0",      "44e3f21f052590ddfabc12909af5188a4cd89d8c", true },
	{MAGIC_2_5_A0_v1,          "2.5a0",      "eb15cdd4a2f1001792074ca0789026989452ff82", false},
	{MAGIC_2_5_A0_v1_U,        "2.5a0",      "eb15cdd4a2f1001792074ca0789026989452ff82", true },
	{MAGIC_2_5_A0_v2,          "2.5a0",      "b6d2f6fd3e116b9b9fe95bc982ac763c359ff103", false},
	{MAGIC_2_5_A0_v2_U,        "2.5a0",      "b6d2f6fd3e116b9b9fe95bc982ac763c359ff103", true },
	{MAGIC_2_5_A0_v3,          "2.5a0",      "5c36c222e7ca5310e5cc8b8db283bd669d1e24d4", false},
	{MAGIC_2_5_A0_v3_U,        "2.5a0",      "5c36c222e7ca5310e5cc8b8db283bd669d1e24d4", true },
	{MAGIC_2_5_B2_v0,          "2.5b2",      "2c3ec720aa7beb0da4002b847cc5ed7dc782566c", false},
	{MAGIC_2_5_B2_v0_U,        "2.5b2",      "2c3ec720aa7beb0da4002b847cc5ed7dc782566c", true },
	{MAGIC_2_5_B2_v1,          "2.5b2",      "b745b3fd66a649a5fa540bdf47971c26af0a959e", false},
	{MAGIC_2_5_B2_v1_U,        "2.5b2",      "b745b3fd66a649a5fa540bdf47971c26af0a959e", true },
	{MAGIC_2_5_C3,             "2.5c3",      "b90a8b0395bd43fd193842451d0c49573b4d7166", false},
	{MAGIC_2_5_C3_U,           "2.5c3",      "b90a8b0395bd43fd193842451d0c49573b4d7166", true },
	{MAGIC_2_6_A0_v0,          "2.6a0",      "8dcb882ec3e1aac7d336a40aa64ec66561fc3dec", false},
	{MAGIC_2_6_A0_v0_U,        "2.6a0",      "8dcb882ec3e1aac7d336a40aa64ec66561fc3dec", true },
	{MAGIC_2_6_A0_v1,          "2.6a0",      "3985d7e2067db75f170e0891994b0fd70963e40b", false},
	{MAGIC_2_6_A0_v1_U,        "2.6a0",      "3985d7e2067db75f170e0891994b0fd70963e40b", true },
	{MAGIC_2_6_A0_v2,          "2.6a0",      "07aa19170a673da6b3e8c4c66bfd868b2f90c0e4", false},
	{MAGIC_2_6_A0_v2_U,        "2.6a0",      "07aa19170a673da6b3e8c4c66bfd868b2f90c0e4", true },
	{MAGIC_2_6_A1_PLUS_v0,     "2.6a1+",     "343597c7d682b3552580352deddd0cdb36978a04", false},
	{MAGIC_2_6_A1_PLUS_v0_U,   "2.6a1+",     "343597c7d682b3552580352deddd0cdb36978a04", true },
	{MAGIC_2_6_A1_PLUS_v1,     "2.6a1+",     "eac41f90296c69c6d07d29f1feb453a4c0e400d1", false},
	{MAGIC_2_6_A1_PLUS_v1_U,   "2.6a1+",     "eac41f90296c69c6d07d29f1feb453a4c0e400d1", true },
	{MAGIC_2_6_A1_PLUS_v2,     "2.6a1+",     "a0ea3a0efc710934ad66e3907211230ff227d6a1", false},
	{MAGIC_2_6_A1_PLUS_v2_U,   "2.6a1+",     "a0ea3a0efc710934ad66e3907211230ff227d6a1", true },
	{MAGIC_2_7_A0_v0,          "2.7a0",      "94e79d78dff0dfb5c53f49842c7df65ad5b79e66", false},
	{MAGIC_2_7_A0_v0_U,        "2.7a0",      "94e79d78dff0dfb5c53f49842c7df65ad5b79e66", true },
	{MAGIC_2_7_A0_v1,          "2.7a0",      "ef8fe90886968b1eb468cb91ebae103f773fa17f", false},
	{MAGIC_2_7_A0_v1_U,        "2.7a0",      "ef8fe90886968b1eb468cb91ebae103f773fa17f", true },
	{MAGIC_2_7_A0_v2,          "2.7a0",      "145376df3ad728f7052fdd8b6eba600a8317fece", false},
	{MAGIC_2_7_A0_v2_U,        "2.7a0",      "145376df3ad728f7052fdd8b6eba600a8317fece", true },
	{MAGIC_2_7_A2_PLUS_v0,     "2.7a2+",     "c2fdf25329ff30cf8d68c0c0e7cf479d7b203745", false},
	{MAGIC_2_7_A2_PLUS_v0_U,   "2.7a2+",     "c2fdf25329ff30cf8d68c0c0e7cf479d7b203745", true },
	{MAGIC_2_7_A2_PLUS_v1,     "2.7a2+",     "edfed0e32cedf3b84c6e999052486a750a3f5bee", false},
	{MAGIC_2_7_A2_PLUS_v1_U,   "2.7a2+",     "edfed0e32cedf3b84c6e999052486a750a3f5bee", true },
	{MAGIC_3_0X_v0,            "3.0x",       "49c6eb688906b1dddabf578f08129e6729d6151f", false},
	{MAGIC_3_0X_v0_U,          "3.0x",       "49c6eb688906b1dddabf578f08129e6729d6151f", true },
	{MAGIC_3_0X_v1,            "3.0x",       "f87a3e61853d72b1d133992f991e397b31aac8e8", false},
	{MAGIC_3_0X_v1_U,          "3.0x",       "f87a3e61853d72b1d133992f991e397b31aac8e8", true },
	{MAGIC_3_0X_v2,            "3.0x",       "d0b83c4630c0924df661063543f3c5478c8c35ac", false},
	{MAGIC_3_0X_v2_U,          "3.0x",       "d0b83c4630c0924df661063543f3c5478c8c35ac", true },
	{MAGIC_3_0X_v3,            "3.0x",       "1cce0526d9b0a53f4ff95713dde153dc70dae2dc", false},
	{MAGIC_3_0X_v3_U,          "3.0x",       "1cce0526d9b0a53f4ff95713dde153dc70dae2dc", true },
	{MAGIC_3_0X_v4,            "3.0x",       "7a35d3d1ac5a301ef3dc52f9140844f0422011a5", false},
	{MAGIC_3_0X_v4_U,          "3.0x",       "7a35d3d1ac5a301ef3dc52f9140844f0422011a5", true },
	{MAGIC_3_0X_v5,            "3.0x",       "793e0323d4d65bfc89b40d78162cd771c575a18e", false},
	{MAGIC_3_0X_v5_U,          "3.0x",       "793e0323d4d65bfc89b40d78162cd771c575a18e", true },
	{MAGIC_3_0X_v6,            "3.0x",       "19f7ff443718f7a9da1aea9edbf00a135f860883", false},
	{MAGIC_3_0X_v6_U,          "3.0x",       "19f7ff443718f7a9da1aea9edbf00a135f860883", true },
	{MAGIC_3_0_A1_v0,          "3.0a1",      "a89d469e1ff77716914ce1a4244fa529a71ce68a", false},
	{MAGIC_3_0_A1_v0_U,        "3.0a1",      "a89d469e1ff77716914ce1a4244fa529a71ce68a", true },
	{MAGIC_3_0_A1_v1,          "3.0a1",      "19319e70fc3edbb45b2d007161c1b3a1de094181", false},
	{MAGIC_3_0_A1_v1_U,        "3.0a1",      "19319e70fc3edbb45b2d007161c1b3a1de094181", true },
	{MAGIC_3_0_A1_PLUS,        "3.0a1+",     "0d462d789b18ec6a59ebe2116688d5b6985c215d", false},
	{MAGIC_3_0_A1_PLUS_U,      "3.0a1+",     "0d462d789b18ec6a59ebe2116688d5b6985c215d", true },
	{MAGIC_3_0_A2,             "3.0a2",      "4dc01402d78afe2c9b4a4bd8004eb08e2647335d", false},
	{MAGIC_3_0_A2_U,           "3.0a2",      "4dc01402d78afe2c9b4a4bd8004eb08e2647335d", true },
	{MAGIC_3_0_A2_PLUS,        "3.0a2+",     "73e1bf179a01ad7824ff5aa2b29ce068a457cd67", false},
	{MAGIC_3_0_A2_PLUS_U,      "3.0a2+",     "73e1bf179a01ad7824ff5aa2b29ce068a457cd67", true },
	{MAGIC_3_0_A3_PLUS,        "3.0a3+",     "832c820e9d144cb76c8778ad6fcffe232b1f5c46", false},
	{MAGIC_3_0_A3_PLUS_U,      "3.0a3+",     "832c820e9d144cb76c8778ad6fcffe232b1f5c46", true },
	{MAGIC_3_0_A5_PLUS,        "3.0a5+",     "212a1fee6bf93f8b74f81dd3567bf964e627ea20", false},
	{MAGIC_3_0_A5_PLUS_U,      "3.0a5+",     "212a1fee6bf93f8b74f81dd3567bf964e627ea20", true },
	{MAGIC_3_1_A0_v0,          "3.1a0",      "2ee4653927f72f9bb3ff14b3083d4a203d684dfc", false},
	{MAGIC_3_1_A0_v0_U,        "3.1a0",      "2ee4653927f72f9bb3ff14b3083d4a203d684dfc", true },
	{MAGIC_3_1_A0_v1,          "3.1a0",      "643d8d4fc8ebcc69155d3416357aadca9c053388", false},
	{MAGIC_3_1_A0_v1_U,        "3.1a0",      "643d8d4fc8ebcc69155d3416357aadca9c053388", true },
	{MAGIC_3_2_A0,             "3.2a0",      "3aaf2e065db05401803705ed4bfa3fd2f9030df8", false},
	{MAGIC_3_2_A0_U,           "3.2a0",      "3aaf2e065db05401803705ed4bfa3fd2f9030df8", true },
	{MAGIC_3_2_A1_PLUS_U,      "3.2a1+",     "72523121127327c022096d30e7b28a4a5a89495d", true },
	{MAGIC_3_2_A2_PLUS_U,      "3.2a2+",     "252895d491570d5a27452809b582717be409b24d", true },
	{MAGIC_3_3_A0_U,           "3.3a0",      "9a6d9ac6fb2e1bb15bbb4e8c2a6c939d07088477", true },
	{MAGIC_3_3_0_A0_v0_U,      "3.3.0a0",    "e1dbc72bd97f36c1aed7e3ba2a58278f4da807be", true },
	{MAGIC_3_3_0_A0_v1_U,      "3.3.0a0",    "87331661042b89022f6f49506ae9c1ae459a95be", true },
	{MAGIC_3_3_0_A1_PLUS_U,    "3.3.0a1+",   "c0a6569fdad624cc89cdd24b68331dc2a9b64827", true },
	{MAGIC_3_3_0_A3_PLUS_U,    "3.3.0a3+",   "96ab78ef82a775da11a538fc47aebe70d9c34f04", true },
	{MAGIC_3_4_0_A0_v0_U,      "3.4.0a0",    "d296cf1600a8c2c7098737944b5ee793b67a6883", true },
	{MAGIC_3_4_0_A0_v1_U,      "3.4.0a0",    "2528e4aea33801b40ec902a77b5451ebc925a331", true },
	{MAGIC_3_4_0_A0_v2_U,      "3.4.0a0",    "cf65c7a75f558e6cd68903f4c2800f6b9574a35f", true },
	{MAGIC_3_4_0_A0_v3_U,      "3.4.0a0",    "3d858f1eef546e6adb2c073be9384065cfc2537e", true },
	{MAGIC_3_4_0_A0_v4_U,      "3.4.0a0",    "6db3741e59be2b6427032a0f51d8a06625d64c28", true },
	{MAGIC_3_4_0_A3_PLUS_v0_U, "3.4.0a3+",   "35b384ed594b4618a7ea345dad7d2149eabcf3e7", true },
	{MAGIC_3_4_0_A3_PLUS_v1_U, "3.4.0a3+",   "bb2affc1e317a85c4edfe450c119bdec851a08ee", true },
	{MAGIC_3_4_0_RC1_PLUS_U,   "3.4.0rc1+",  "e301a515f8f4c5cdde3b9726ec298bd4de1af963", true },
	{MAGIC_3_5_0_A0_U,         "3.5.0a0",    "c553d8f72d659b3bc14fe326662ba53ca97bf38a", true },
	{MAGIC_3_5_0_A4_PLUS_U,    "3.5.0a4+",   "a65f685ba8c011bf117cadf26c13ab7a0cbb122c", true },
	{MAGIC_3_5_0_B1_PLUS_U,    "3.5.0b1+",   "6f05f83c7010764aff53793fbff162c42018f57e", true },
	{MAGIC_3_5_0_B2_PLUS_U,    "3.5.0b2+",   "7a0a1a4ac63942f4ea3c7804e323adf668d40a21", true },
	{MAGIC_3_6_0_A0_v0_U,      "3.6.0a0",    "1ddeb2e175df5009571b3632a709c6b74995cb29", true },
	{MAGIC_3_6_0_A0_v1_U,      "3.6.0a0",    "775b74e0e103f816382a0fc009b6ac51ea956750", true },
};

struct pyc_version get_pyc_version(ut32 magic) {
	struct pyc_version fail = {-1, 0, 0, false};
	ut32 i;
	for (i = 0; i < sizeof (versions) / sizeof (*versions); ++i)
		if (versions[i].magic == magic)
			return versions[i];
	return fail;
}
